# Quant Analysis Platform
## Overview
The Quant Analysis Platform is a robust web-based application designed to empower investors, financial analysts, data analysts, and quantitative traders with sophisticated tools for **comprehensive financial analysis**, **data visualization**, and **automated report generation**. By leveraging large language models (LLMs) for news sentiment analysis and trend predictions, alongside real-time financial data from external APIs, the platform delivers actionable insights for data-driven investment decisions.

This README provides a comprehensive overview of the project, its architecture, setup instructions, testing framework, and development guidelines to ensure a smooth understanding and contribution process for new developers.

## Table of Contents
1.  [Project Purpose](#1-project-purpose)
2.  [Key Features](#2-key-features)
3.  [System Architecture](#3-system-architecture)
4.  [Technology Stack](#4-technology-stack)
5.  [Folder Structure](#5-folder-structure)
6.  [Setup Instructions](#6-setup-instructions)
    * [Prerequisites](#prerequisites)
    * [Local Development Environment](#local-development-environment)
    * [Database Setup](#database-setup)
    * [Running the Application](#running-the-application)
7.  [Testing Framework](#7-testing-framework)
8.  [API Endpoints](#8-api-endpoints)
9.  [Scheduled Tasks](#9-scheduled-tasks)
10. [Frontend Functionality](#10-frontend-functionality)
11. [Development Guidelines](#11-development-guidelines)
12. [Future Considerations](#12-future-considerations)
13. [Contact](#13-contact)
---

## 1. Project Purpose
The Quant Analysis Platform aims to provide:

* **Investors**: Automated insights and visualizations for informed investment decisions, specifically through LLM-analyzed news sentiment reports.
* **Financial Analysts**: Tools for in-depth analysis, prompt refinement for LLM models, and comprehensive report review capabilities.
* **System Administrators**: User management and security controls for platform maintenance.
* **Data Analysts/Researchers**: Access to raw market data for modeling and further analysis.
* **Quantitative Traders**: Capabilities for backtesting and strategy simulation (planned for future development).

The platform emphasizes an LLM-driven development process, utilizing best practices and step-by-step instructions generated by LLMs to guide implementation.

## 2. Key Features
The platform focuses on delivering the following core functionalities:

* **Core Data Storage & Financial Data Acquisition (Completed - Priority 1)**:
    * Establishes essential data storage for companies, financial data, news, reports, alerts, prompt versions, and feedback.
    * Initial data acquisition for financial and historical data from `yfinance`.
    * Basic UI on the investor dashboard for verifying data retrieval and display.
* **News, Sentiment Analysis Integration (Completed - Priority 2)**:
    * Utilizes Google Gemini API (`gemini-2.0-flash-lite-model`) for news summarization and sentiment analysis (positive, negative, neutral).
    * Retrieves industry-specific news articles from The Guardian API.
    * Integrates LLM-driven insights into investment analysis reports.
* **Graph & Basic Financial Trend Visualization (Completed - Priority 3)**:
    * Enables daily generation of price charts (OHLCV) and basic trend visualizations.
    * Provides API endpoints for fetching chart data (daily, weekly, monthly, yearly, max).
* **User Authentication and Authorization (In Progress - Priority 4)**:
    * Secure user login and registration.
    * Role-based access control (user, staff, admin).
* **Automated Alerting System (Planned - Priority 5)**:
    * Real-time alerts based on predefined financial metrics or news events.
* **Comprehensive Report Generation & Management (Planned - Priority 6)**:
    * Generates detailed investment analysis reports incorporating LLM-driven news sentiment.
    * Reports can be explicitly linked to specific LLM prompt versions for reproducibility and tracking.
    * Report review and feedback mechanisms.
* **Prompt Management and Versioning (Planned - Priority 7)**:
    * Manages and versions LLM prompts in the `prompt_versions` table.
    * Facilitates A/B testing of prompts to optimize LLM performance.
* **Feedback and Refinement Loop (Planned - Priority 8)**:
    * Allows users to provide feedback on generated reports and LLM analysis, aiding continuous improvement.
* **Advanced Data Visualization and Customization (Planned - Priority 9)**:
    * Enhancements to existing charts and introduction of new visualization types.
* **Backtesting and Strategy Simulation (Planned - Priority 10)**:
    * Enables quantitative traders to define and test trading strategies against historical data.

## 3. System Architecture
The Quant Analysis Platform follows a client-server architecture with distinct backend and frontend components.

```mermaid
graph TD
    subgraph Quant Analysis Platform
        A[User (Investor, Analyst, Admin)] --> B(Frontend (Bootstrap));
        B --> C(API Layer);
        C --> D(Backend (Python Flask));
        D --> E(External System);
    end
    subgraph Frontend (Bootstrap)
        B1[Bootstrap Frontend];
    end
    subgraph API Layer
        C1[API Gateway];
    end
    subgraph Backend (Python Flask)
        D1[Python Flask Backend];
        D2[User Management Service];
        D3[Data Acquisition & Storage Service];
        D4[LLM Integration Service];
        D5[Report Generation Service];
        D6[Database (MySQL)]
        D4 --> D6;
        D5 --> D6;
        D3 --> D6;
        D2 --> D6;
        D6 --- D4;
        D6 --- D5;
        D6 --- D3;
        D6 --- D2;
    end
    subgraph External System
        E1[Yahoo Finance API];
        E2[The Guardian API];
        E3[Google Gemini API];
        E4[Perplexity AI (Planned)];
    end
    D3 --> E1;
    D3 --> E2;
    D4 --> E3;
    D4 --> E4;
````

  * **Frontend**: Built with Bootstrap, HTML, CSS, and JavaScript. It provides the user interface for data display, interaction, and report viewing.
  * **API Layer**: Serves as the interface between the frontend and backend, handling requests and responses.
  * **Backend**: Developed with Python Flask, it manages business logic, data processing, user authentication, and interactions with external APIs and the database. Key services include:
      * **User Management Service**: Handles user registration, login, and roles.
      * **Data Acquisition & Storage Service**: Fetches financial and news data and stores it in the database.
      * **LLM Integration Service**: Interacts with Large Language Models for sentiment analysis and report generation.
      * **Report Generation Service**: Compiles and formats investment analysis reports.
  * **Database**: MySQL is used for persistent storage of company data, financial data, news, user information, reports, alerts, and LLM prompts.
  * **External Systems**: Integration with third-party APIs like Yahoo Finance (via `yfinance`), The Guardian API, and Google Gemini API for data acquisition and LLM functionalities. Perplexity AI is a planned future integration.

## 4\. Technology Stack

  * **Backend**:
      * **Framework**: Flask (Python)
      * **Database ORM**: SQLAlchemy
      * **Database**: MySQL
      * **Data Acquisition**: `yfinance`, `requests` (for Guardian API)
      * **LLM Integration**: `google-generativeai` (for Gemini API)
      * **Scheduled Tasks**: `APScheduler`
      * **Data Analysis**: `pandas`, `numpy`
      * **Web Server (Deployment)**: `gunicorn`
      * **CORS**: `flask-cors`
  * **Frontend**:
      * **UI Framework**: Bootstrap 4.5.2
      * **Charting Library**: Chart.js
      * **Date Picker**: Flatpickr
      * **Select/Dropdowns**: Select2
      * **JavaScript Libraries**: jQuery
  * **Testing**:
      * `pytest`
      * `flask-testing`
      * `unittest-mock`

## 5\. Folder Structure
```
QuantAnalysisPlatform/
├── backend/
│   ├── __init__.py
│   ├── api.py                      # Main API entry point (e.g., for company details, financial data)
│   ├── app.py                      # Flask application setup
│   ├── config.py                   # Configuration settings
│   ├── database.py                 # Database connection and session management
│   ├── tasks.py                    # Scheduled background tasks (e.g., daily data updates)
│   ├── .env                        # Environment variables (e.g., API keys, DB credentials)
│   ├── models/
│   │   ├── __init__.py             # Initializes models for SQLAlchemy
│   │   ├── alert_model.py          # SQLAlchemy model for alerts
│   │   ├── data_model.py           # SQLAlchemy models for companies, financial_data, news
│   │   ├── feedback_model.py       # SQLAlchemy model for user feedback
│   │   ├── prompt_model.py         # SQLAlchemy model for LLM prompt versions
│   │   ├── report_model.py         # SQLAlchemy model for reports
│   │   ├── user_model.py           # SQLAlchemy model for user authentication
│   │   └── backtest_model.py       # NEW: For backtesting results and strategies (planned)
│   ├── routes/
│   │   ├── __init__.py             # Initializes API routes
│   │   ├── alert_routes.py         # Unused: For alert management API endpoints (planned)
│   │   ├── backtesting_routes.py   # NEW: For backtesting API endpoints (planned)
│   │   ├── data_routes.py          # API endpoints for financial and company data
│   │   ├── download_routes.py      # (If implemented) for data downloads
│   │   ├── feedback_routes.py      # Unused: For user feedback API endpoints (planned)
│   │   ├── graph_routes.py         # API endpoints for graph data
│   │   ├── llm_routes.py           # API endpoints for LLM-related functionalities (e.g., sentiment analysis)
│   │   ├── prompt_routes.py        # Unused: For LLM prompt management API endpoints (planned)
│   │   ├── report_routes.py        # Unused: For report management API endpoints (planned)
│   │   └── user_routes.py          # Unused: For user authentication and management (planned)
│   ├── services/
│   │   ├── __init__.py             # Initializes services
│   │   ├── data_service.py         # Business logic for data fetching and processing
│   │   └── llm_service.py          # Business logic for LLM interactions (e.g., sentiment analysis)
│   ├── tests/                      # Unit and integration tests for backend components
│   │   ├── __init__.py
│   │   ├── test_data_service.py
│   │   ├── test_llm_service.py
│   │   ├── test_routes.py
│   │   └── test_backtesting_service.py # NEW: Tests for backtesting service (planned)
│   └── db/                         # Database schema definition files (e.g., SQL scripts)
│       ├── tables/                 # Individual SQL table creation scripts
│       └── views/                  # Individual SQL view creation scripts
├── frontend/
│   ├── static/
│   │   ├── css/
│   │   │   └── style.css           # Custom CSS for the application
│   │   ├── img/                    # Images used in the UI
│   │   └── js/                     # Global JavaScript files
│   │       ├── base.js             # Base JS for common functions and conditional links
│   │       ├── auth/               # NEW
│   │       │   ├── login.js        # NEW: JS for login page
│   │       │   └── register.js     # NEW: JS for registration page
│   │       ├── staff/              # For Analyst/Admin specific UIs
│   │       │   ├── prompt_management.js # unused: JS for prompt management UI (planned)
│   │       │   ├── user_management # unused: JS for User management UI (planned)
│   │       │   └── feedback_review.js # NEW: JS for feedback review UI (planned)
│   │       └── user/               # For general user UIs
│   │           ├── alerts.js       # NEW: JS for alerts UI (planned)
│   │           ├── backtesting.js  # Unused: JS for backtesting UI (planned)
│   │           ├── reports.js      # NEW: JS for reports UI (planned)
│   │           └── company_details.js # JS for company details page and graphs
│   │           └── dashboard.js    # JS for the main dashboard functionality
│   ├── templates/                  # HTML templates rendered by Flask
│   │   ├── base.html               # Base template for common layout
│   │   ├── dashboard.html          # Main dashboard HTML
│   │   ├── company_details.html    # Company-specific details page HTML
│   │   ├── auth/                   # NEW
│   │   │   ├── login.html          # NEW: Login page
│   │   │   └── register.html       # NEW: Registration page
│   │   ├── staff/                  # For Analyst/Admin specific UIs
│   │   │   ├── feedback_review.html # NEW: Feedback review UI (planned)
│   │   │   ├── user_management     # unused: User management UI (planned)
│   │   │   └── prompt_management.html # Unused: Prompt management UI (planned)
│   │   └── user/                   # For general user UIs
│   │       ├── alerts.html         # NEW: Alerts management UI (planned)
│   │       ├── backtesting.html    # Unused: Backtesting UI (planned)
│   │       ├── reports.html        # NEW: Reports management UI (planned)
├── .gitignore                      # Specifies intentionally untracked files to ignore
├── APIdocumentation.md             # Detailed API documentation
├── requirements.txt                # Python dependencies
├── README.md                       # Project overview and setup guide
└── (other project-level files)
```

## 6\. Setup Instructions
Follow these steps to set up and run the Quant Analysis Platform locally.

### Prerequisites
  * **Python 3.x**: Ensure you have Python installed. It's recommended to use a virtual environment.
  * **MySQL Database**: A running MySQL server instance.
  * **External API Keys**:
      * **Yahoo Finance API**: Accessed via `yfinance` library. No direct API key needed, but subject to `yfinance` usage policies.
      * **The Guardian API**: Requires an API key. Set it as an environment variable: `GUARDIAN_API_KEY`.
      * **Google Generative AI (Gemini API)**: Requires an API key. Set it as an environment variable: `GEMINI_API_KEY`. The model used is `gemini-2.0-flash-lite`.
      * **Perplexity AI API (Planned)**: Would require `PERPLEXITY_API_KEY` (currently not in use).

### Local Development Environment
1.  **Clone the repository**:
    ```bash
    git clone <repository_url>
    cd QuantAnalysisPlatform
    ```
2.  **Create a Python virtual environment** (recommended):
    ```bash
    python -m venv venv
    ```
3.  **Activate the virtual environment**:
      * On Windows: `venv\Scripts\activate`
      * On macOS/Linux: `source venv/bin/activate`
4.  **Install Python dependencies**:
    Navigate to the `backend/` directory and install the required libraries:
    ```bash
    pip install -r requirements.txt
    ```

### Database Setup
1.  **Configure Database Credentials**:
    Create a `.env` file in the `backend/` directory (if it doesn't exist) and add your MySQL database connection string. Replace placeholders with your actual credentials:
    ```
    DATABASE_URL="mysql+pymysql://user:password@host:port/database_name"
    # Example: DATABASE_URL="mysql+pymysql://root:my_password@localhost:3306/quant_db"
    GUARDIAN_API_KEY="your_guardian_api_key"
    GEMINI_API_KEY="your_gemini_api_key"
    ```
2.  **Create Database Tables and Views**:
    The database schema is defined in the SQLAlchemy models within `backend/models/` and explicitly documented in `datatables.md`.
    You will need to create the database and tables manually or use a script. The `backend/database.py` likely contains logic to create tables if they don't exist upon application startup.
    The primary tables are: `users`, `companies`, `financial_data`, `news`, `reports`, `alerts`, `prompt_versions`, and `feedback`. Views include `latest_financial_data`, `report_details`, and `feedback_details`.

### Running the Application
1.  **Navigate to the backend directory**:
    ```bash
    cd backend
    ```
2.  **Run the Flask application**:
    ```bash
    flask run --host=0.0.0.0 --port=8000
    ```
    The application will typically run on `http://localhost:8000`.

## 7\. Testing Framework
The project includes a robust testing framework using `pytest` for backend components.
  * **Test Coverage**: Tests are designed to cover various services and routes, ensuring data acquisition, LLM integration, and API endpoints function correctly.
  * **Running Tests**:
    Navigate to the `backend/` directory and execute:
    ```bash
    pytest
    ```
    Specific test files exist for `data_service`, `llm_service`, and routes (e.g., `test_data_service.py`, `test_llm_service.py`, `test_routes.py`). Frontend tests are not explicitly set up but could be implemented using frameworks like Jest or Cypress.

## 8\. API Endpoints
The API provides structured access to financial data, news analysis, and graphing capabilities. For a comprehensive and detailed list of all API endpoints, their parameters, request/response schemas, and example usage, please refer to the dedicated: **[APIdocumentation.md]**
Below is a summary of the key API route categories:
  * **Data Routes (`/api/data`)**:
      * `/api/data/companies`: Get a list of all companies.
      * `/api/data/company/<ticker>`: Get company details by ticker, including current news and industry news.
      * `/api/data/financials/<int:company_id>`: Get latest financial data for a company.
      * `/api/data/financial-history/<int:company_id>/<string:period>`: Get historical financial data (daily, weekly, monthly, yearly averages).
      * `/api/data/news`: Get news articles for a selected company.
      * `/api/data/ingest-financial-data`: Trigger manual ingestion of financial data.
  * **Graph Routes (`/api/graph`)**:
      * `/api/graph/company/<int:company_id>/<string:timeframe>`: Retrieve graph data (close price, volume) for a company over specified timeframes (weekly, monthly, yearly, max).
  * **LLM Routes (`/api/llm`)**:
      * `/api/llm/sentiment/<int:company_id>`: Retrieves news for a company and analyzes its sentiment using the Gemini LLM. Returns a detailed sentiment report.

## 9\. Scheduled Tasks
The platform includes background tasks to ensure data freshness:
  * **Daily News and Financial Data Updates**: Automated via `tasks.py` and `APScheduler`. This ensures that `financial_data` and `news` tables are kept up-to-date. The `needs_update` function in `data_routes.py` checks if data is older than 24 hours.

## 10\. Frontend Functionality
The user interface provides intuitive ways to interact with the platform:
  * **Dashboard (`dashboard.html`, `dashboard.js`)**:
      * Displays a paginated list of companies and their latest financial data.
      * Allows searching companies by name or ticker.
      * Provides filters for industry and date ranges.
      * Enables manual data ingestion for specific tickers.
      * Includes dynamic pagination and sorting capabilities.
  * **Company Details Page (`company_details.html`, `company_details.js`)**:
      * Shows detailed information for a selected company (name, ticker, exchange, industry).
      * Displays interactive financial charts (weekly, monthly, yearly, max timeframe views).
      * Presents the latest company-specific and industry news.
      * Integrates and displays LLM-generated sentiment analysis reports for the company's news. Users can trigger updates for these reports.

## 11\. Development Guidelines
  * **LLM-Driven Development**: Utilize LLM prompts for generating code snippets, adhering to best practices, and optimizing solutions. Prompts used should be stored and versioned in the `prompt_versions` table.
  * **Logging**:
      * Use Python’s `logging` module for backend services (`data_service.py`, `llm_service.py`, `tasks.py`) for detailed debug and error tracking.
      * Use `console.log` with `[DEBUG]` or `[ERROR]` prefixes in frontend JavaScript for debugging.
      * Enable debug logging in tests (e.g., `logging.basicConfig(level=logging.DEBUG)` in test files).
  * **Documentation**:
      * Keep this `README.md` updated with major changes and new features.
      * Maintain `APIdocumentation.md` for detailed API specifications.
      * Add comments to JavaScript functions and test cases for clarity and maintainability.
  * **Code Quality**: Adhere to PEP 8 for Python and maintain consistent coding styles across the project.
  * **Version Control**: Follow standard Git workflow (branching, pull requests, clear commit messages).

## 12\. Future Considerations
The platform is designed for extensibility, with several planned enhancements:
  * **Predictive Financial Trends**: Implement the `predict_financial_trends` function in `data_service.py` to offer forward-looking insights.
  * **Similar Companies Identification**: Complete the `get_similar_companies` function in `data_service.py` for comparative analysis.
  * **Perplexity AI Integration**: Fully integrate the `analyze_news_sentiment_perplexity` function in `llm_service.py` to diversify LLM providers.
  * **Advanced LLM Capabilities**: Explore and integrate more advanced LLM functions for deeper financial analysis, trend predictions, and sophisticated report generation.
  * **A/B Testing for LLM Prompts**: Implement a framework for A/B testing different LLM prompts, leveraging the `operative` flag and `versioning` in the `prompt_versions` table.
  * **Enhanced Data Visualization**: Integrate more advanced charting libraries (e.g., Plotly) and add export functionality for reports and charts.
  * **Real-time Data and Webhook Support**: Implement mechanisms for real-time data streaming and webhook notifications.
  * **Mobile App and Customizable Dashboards**: Future expansion to mobile platforms and personalized dashboard layouts.
  * **Optimization**: Continuously optimize scheduled tasks for scalability and robust handling of API rate limits.
  * **Expanded Test Coverage**: Increase test coverage for frontend JavaScript components and handle more edge cases in backend logic.

## 13\. Contact
For questions, support, or contributions, please contact the project maintainer at Whatsapp (get contact from Supervisor) or open an issue on the GitHub repository.
*Generated on May 29, 2025*